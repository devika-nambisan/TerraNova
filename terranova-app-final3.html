<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TerraNova</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.15.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>

  <style>
    :root{
      --bg:#07112a;
      --card:#0f203a;
      --accent:#6c5ce7;
      --accent-2:#22c1c3;
      --muted:#9aa9c7;
      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.02);
      --radius:14px;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: linear-gradient(180deg,var(--bg) 0%, #031226 100%);
      color:#eaf1ff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }
    .container{max-width:1200px;margin:40px auto;padding:20px;}
    header{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:20px}
    .logo-wrap{display:flex;align-items:center;gap:12px}
    .logo{
      display:flex;align-items:center;justify-content:center;
    }
    .logo img {
      width: 160px;
      height: 128px;
      border-radius: 50%;
      display: block;
    }
    h1{font-size:3.5rem;margin:0;font-weight:700;letter-spacing:-0.3px}
    .tag{font-weight:600;color:var(--muted);font-size:0.9rem}
    main{display:grid;grid-template-columns:1fr 420px;gap:20px;align-items:start}
    @media (max-width:980px){main{grid-template-columns:1fr;} .side{order:2}}
    .card{background:linear-gradient(180deg,var(--glass), var(--glass-2)); padding:20px;border-radius:var(--radius);box-shadow: 0 6px 30px rgba(8,15,28,0.6); border:1px solid rgba(255,255,255,0.03)}
    .hero{padding:28px;border-radius:20px;background:linear-gradient(180deg, rgba(102,58,183,0.12), rgba(10,16,30,0.02));display:flex;gap:20px;align-items:center}
    .hero-text{flex:1}
    .hero h2{margin:0 0 6px 0;font-size:1.25rem}
    .hero p{margin:0;color:var(--muted)}
    .cta-row{display:flex;gap:10px;margin-top:14px}
    .btn{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600;box-shadow:0 6px 18px rgba(108,92,231,0.14)}
    .btn.alt{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .scanner{display:flex;flex-direction:column;gap:12px}
    .video-wrap{position:relative;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
    video{display:block;width:100%;height:260px;object-fit:cover;background:linear-gradient(180deg,#021323,#05263b)}
    .scan-controls{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .prediction{font-weight:700}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:600}
    .guide-list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
    @media (max-width:720px){.guide-list{grid-template-columns:1fr}}
    .guide-item{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.02)}
    .map{height:300px;border-radius:12px;overflow:hidden;margin-top:10px}
    .galaxy-wrap{height:220px;display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center}
    canvas#galaxy{width:100%;height:160px;border-radius:10px;display:block;background:transparent}
    .stars-count{font-size:1.25rem;font-weight:700}
    h3{margin-top:0}
    .cols{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:720px){.cols{grid-template-columns:1fr}}
    footer{margin-top:30px;color:var(--muted);font-size:0.9rem;text-align:center}
    .muted{color:var(--muted);font-size:0.95rem}
    .chip{padding:6px 8px;background:rgba(255,255,255,0.02);border-radius:999px;font-weight:600}
    .team-grid{display:flex;gap:10px;flex-wrap:wrap}
    .team-card{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));min-width:150px}
    pre{background:#071b2a;padding:12px;border-radius:8px;overflow:auto;font-size:0.9rem;color:#cce7ff}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo-wrap">
        <div class="logo" aria-hidden="true">
          <img src="Logo.jpeg" alt="TerraNova Logo">
        </div>
      </div>
      <div>
        <h1>TerraNova</h1>
        <div class="tag">Scan • Dispose • Make a Difference</div>
      </div>
    </header>

    <main>
      <section>
        <div class="card hero">
          <div class="hero-text">
            <h2>Make sustainable disposal as easy as a scan.</h2>
            <p>Terranova means “New Earth,” and that’s exactly what we want to create. Every day, millions of people want to do the right thing for the planet,  to recycle, compost, or dispose of waste responsibly, but they don't know where their trash really belongs. Mismanaged waste contributes to overflowing landfills, ocean pollution, and environmental degradation.</p>
            <br>
            <p>We built Terranova to bridge this gap. Our app makes responsible waste disposal as simple and immediate as scanning a barcode, empowering everyone to take small, everyday actions that add up to meaningful environmental change.
            </p>
            <div class="cta-row">
              <button class="btn" id="open-scan">Try Scan Demo</button>
              <a class="btn alt" href="#how">How it works</a>
            </div>
          </div>
        </div>

       <section style="margin-top:18px" class="card">
         <h3 id="how">How TerraNova works</h3>
         <div class="cols">
           <div>
             <h4>1. Scan</h4>
             <p class="muted">Open the app and use your camera to take a quick photo of the item.</p>
           </div>
           <div>
             <h4>2. Classify</h4>
             <p class="muted">A trained model identifies the material (plastic, glass, metal, paper, compostable, e-waste, etc.).</p>
           </div>
           <div>
             <h4>3. Dispose</h4>
             <p class="muted">TerraNova gives localized disposal instructions and shows nearby drop-off centers on a map.</p>
           </div>
           <div>
             <h4>4. Earn & Share</h4>
             <p class="muted">Earn stars for correct disposals and grow your personal galaxy. Share milestones with friends.</p>
           </div>
         </div>

         <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:12px 0"/>
        </section>
      
       <section class="card" style="margin-top:18px;">
         <h3>Scan Demo (Enhanced Detection)</h3>
         <p class="muted">This demo uses MobileNet with enhanced recycling material detection. The model identifies objects and maps them to recyclable categories.</p>

         <div class="scanner" id="scanner">
           <div class="video-wrap">
             <video id="video" autoplay playsinline muted></video>
           </div>

           <div class="scan-controls">
             <div>
               <button id="capture" class="btn">Capture Photo</button>
               <button id="toggle" class="btn alt">Stop Camera</button>
             </div>
             <div style="text-align:right">
               <div class="muted">Prediction: <span id="prediction" class="badge">—</span></div>
             </div>
           </div>

           <div id="capture-result" style="display:none">
             <h4>Result</h4>
             <div style="display:flex;gap:12px;align-items:center">
               <canvas id="snapshot" width="320" height="200" style="border-radius:8px"></canvas>
               <div style="flex:1">
                 <div id="disposal" class="muted">—</div>
                 <div style="height:8px"></div>
                 <button class="btn" id="mark-correct">Mark Disposed Correctly & Earn Star</button>
               </div>
             </div>
           </div>

           <details style="margin-top:12px;color:var(--muted)">
             <summary style="cursor:pointer">Developer notes: ML integration</summary>
             <div style="margin-top:8px">
               <p class="muted">This demo uses MobileNet with an enhanced mapping system for recycling materials. For production, consider training a custom model on recycling-specific dataset.</p>
             </div>
           </details>
         </div>
       </section>

       <section style="margin-top:18px" class="card">
        <h3 id="how">Why this Matters</h3>
        <ul style="color:var(--muted);margin:6px 0 0 18px">
          <li>Reduces contamination in recycling streams</li>
          <li>Helps communities find correct disposal options</li>
          <li>Turns sustainability into repeatable, positive habits</li>
          <li>Users want to make a positive impact without feeling unsure or overwhelmed.</li>
        </ul>
      </section>
    </section>

    <class="side">
      <div class="card" style="margin-top:14px">
        <h3>Nearby Drop-off Centers</h3>
        <p class="muted">Map shows mock drop-off centers for demo. Replace with real API or a curated database per city.</p>
        <div id="map" class="map"></div>
        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn alt" id="locate">Use My Location</button>
          <button class="btn" id="showAll">Show All Centers</button>
        </div>
      </div>

      <div class="card" style="margin-top:18px">
        <h3>Your Galaxy</h3>
        <div class="galaxy-wrap">
          <canvas id="galaxy"></canvas>
          <div class="stars-count"><span id="stars">0</span> stars</div>
          <div class="muted">Earn stars by correctly disposing items. grow your celestial garden.</div>
        </div>
      </div>

      <section class="card" style="margin-top:18px;">
        <h3>Disposal Guide</h3>
        <div class="guide-list">
          <div class="guide-item">
            <strong>Plastic (bottles, containers)</strong>
            <p class="muted">Rinse, remove caps if required by your local program, place in recycling bin.</p>
          </div>
          <div class="guide-item">
            <strong>Paper & Cardboard</strong>
            <p class="muted">Flatten boxes, keep dry. No greasy pizza boxes.</p>
          </div>
          <div class="guide-item">
            <strong>Glass</strong>
            <p class="muted">Rinse, separate by color if local rules require it.</p>
          </div>
          <div class="guide-item">
            <strong>Metal</strong>
            <p class="muted">Rinse cans; aerosol cans may be hazardous — check local rules.</p>
          </div>
          <div class="guide-item">
            <strong>Compostable</strong>
            <p class="muted">Food scraps, paper towels — use municipal compost or home composting.</p>
          </div>
          <div class="guide-item">
            <strong>e-Waste & Hazardous</strong>
            <p class="muted">Batteries, electronics, chemicals: drop-off centers only.</p>
          </div>
        </div>
      </section>

      <div class="card" style="margin-top:14px">
        <h3>Developers</h3>
        <div class="team-grid">
          <div class="team-card"><strong>Abhinaya Guduru</strong></div>
          <div class="team-card"><strong>Devika Nambisan</strong></div>
          <div class="team-card"><strong>Sanjita Kelkar</strong></div>
          <div class="team-card"><strong>Tejoo Kalikiri</strong></div>
        </div>
      </div>
    </aside>
  </main>

  <footer>
    <div class="muted">TerraNova • HackTx</div>
  </footer>
</div>

<script>
(() => {
 const video = document.getElementById('video');
 const captureBtn = document.getElementById('capture');
 const toggleBtn = document.getElementById('toggle');
 const snapshotCanvas = document.getElementById('snapshot');
 const predLabel = document.getElementById('prediction');
 const disposalEl = document.getElementById('disposal');
 const captureResult = document.getElementById('capture-result');
 const markCorrectBtn = document.getElementById('mark-correct');
 const openScan = document.getElementById('open-scan');

 let stream = null;
 let cameraOn = false;
 let mobilenetModel;

 async function startCamera(){
   try{
     stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' }, audio:false });
     video.srcObject = stream;
     cameraOn = true;
     toggleBtn.textContent = 'Stop Camera';
   }catch(e){
     alert('Camera access is required for the scan demo. Check permissions.');
   }
 }

 async function stopCamera(){
   if(stream){
     stream.getTracks().forEach(t => t.stop());
     video.srcObject = null;
   }
   cameraOn = false;
   toggleBtn.textContent = 'Start Camera';
 }

 toggleBtn.addEventListener('click', async () => {
   if(!cameraOn) await startCamera();
   else await stopCamera();
 });

 openScan.addEventListener('click', async () => {
   document.getElementById('scanner').scrollIntoView({behavior:'smooth'});
   if(!cameraOn) await startCamera();
 });

 async function loadModel() {
   predLabel.textContent = "Loading model...";
   try {
     mobilenetModel = await mobilenet.load();
     predLabel.textContent = "Model ready!";
   } catch(e) {
     predLabel.textContent = "Error loading model";
   }
 }

 loadModel();

 // Enhanced classification mapping
 const recyclableMap = {
   // Plastic items
   plastic: ['bottle', 'water bottle', 'pop bottle', 'plastic bag', 'container', 'cup', 'soda can', 'milk can', 'pill bottle', 'shampoo', 'detergent', 'bucket', 'ladle', 'pitcher', 'jug', 'straw', 'utensil'],
   
   // Glass items
   glass: ['wine bottle', 'beer bottle', 'vase', 'jar', 'beaker', 'glass', 'goblet', 'measuring cup'],
   
   // Metal items
   metal: ['can', 'tin', 'beer can', 'pop can', 'aluminum', 'steel', 'frying pan', 'wok', 'pot', 'kettle', 'opener', 'spatula', 'ladle', 'strainer', 'safe', 'lock', 'chain'],
   
   // Paper items
   paper: ['book', 'notebook', 'envelope', 'comic book', 'menu', 'newspaper', 'tissue', 'toilet tissue', 'paper towel', 'carton', 'box', 'cardboard', 'matchstick', 'packet'],
   
   // Compostable items
   compostable: ['banana', 'orange', 'lemon', 'apple', 'strawberry', 'pineapple', 'pomegranate', 'cucumber', 'mushroom', 'cauliflower', 'broccoli', 'bell pepper', 'zucchini', 'butternut squash', 'acorn squash', 'spaghetti squash', 'artichoke', 'cardoon', 'head cabbage', 'fig', 'pineapple', 'guacamole', 'burrito', 'bagel', 'pretzel', 'french loaf', 'mashed potato', 'plate'],
   
   // E-waste items
   ewaste: ['laptop', 'notebook computer', 'desktop computer', 'monitor', 'screen', 'mouse', 'keyboard', 'remote control', 'cellular telephone', 'modem', 'ipod', 'cd player', 'hard disc', 'battery', 'printer', 'router', 'electric fan', 'microwave', 'toaster', 'coffee maker', 'vacuum']
 };

 captureBtn.addEventListener('click', async () => {
   if (!cameraOn) {
     await startCamera();
     await new Promise(r => setTimeout(r, 250));
   }

   const ctx = snapshotCanvas.getContext('2d');
   const w = snapshotCanvas.width;
   const h = snapshotCanvas.height;
   ctx.drawImage(video, 0, 0, w, h);

   predLabel.textContent = "Classifying...";
   
   try {
     if (!mobilenetModel) {
       predLabel.textContent = "Model not ready";
       return;
     }

     const input = tf.browser.fromPixels(snapshotCanvas)
       .resizeNearestNeighbor([224, 224])
       .toFloat()
       .expandDims();

     const predictions = await mobilenetModel.classify(input);
     tf.dispose(input);

     // Check top 3 predictions for better accuracy
     let bestMatch = null;
     let bestCategory = 'Unknown';

     for (let pred of predictions.slice(0, 3)) {
       const rawLabel = pred.className.toLowerCase();
       
       for (let [category, keywords] of Object.entries(recyclableMap)) {
         if (keywords.some(k => rawLabel.includes(k) || k.includes(rawLabel))) {
           bestMatch = pred;
           bestCategory = category;
           break;
         }
       }
       if (bestMatch) break;
     }

     const displayCategory = bestCategory.charAt(0).toUpperCase() + bestCategory.slice(1);
     const confidence = bestMatch ? (bestMatch.probability * 100).toFixed(1) : '0';
     const detectedItem = bestMatch ? bestMatch.className : predictions[0].className;

    predLabel.textContent = `${displayCategory} (${confidence}%) `; 
    //<!-- detected: ${detectedItem}`;-->
     disposalEl.innerHTML = renderDisposal(displayCategory);
     captureResult.style.display = 'block';

   } catch(e) {
     predLabel.textContent = "Classification error";
   }
 });

 function renderDisposal(category){
   const disposalInfo = {
     Plastic: `<strong>Plastic</strong><div class="muted">Rinse when possible. Put in recycling bin if your city accepts #1-#7. Check for recycling symbol on bottom. Remove caps if required.</div>`,
     Glass: `<strong>Glass</strong><div class="muted">Rinse and place in glass recycling where accepted. Separate by color if required. Fragile glass (light bulbs, mirrors) are hazardous — use drop-off.</div>`,
     Paper: `<strong>Paper / Cardboard</strong><div class="muted">Keep dry, flatten boxes. Remove any plastic windows or tape. No greasy pizza boxes or paper towels in recycling.</div>`,
     Metal: `<strong>Metal</strong><div class="muted">Rinse cans and tins. Aluminum and steel cans are widely recyclable. Aerosols must be empty. Check local rules for scrap metal.</div>`,
     Compostable: `<strong>Compostable</strong><div class="muted">Food scraps, fruit and vegetable waste, coffee grounds can go to compost (municipal or home). No meat, dairy, or oils in most home composting.</div>`,
     Ewaste: `<strong>E-Waste</strong><div class="muted">Electronics, batteries, and cables should NEVER go in regular trash. Take to designated e-waste drop-off centers. Many contain hazardous materials.</div>`,
     Unknown: `<strong>Unknown Item</strong><div class="muted">We couldn't identify this item clearly. Try retaking the photo with better lighting, or check your local waste management guidelines.</div>`
   };
   
   return disposalInfo[category] || disposalInfo.Unknown;
 }

 const starsCounterEl = document.getElementById('stars');
 function getStars(){ return parseInt(localStorage.getItem('tn_stars')||'0',10); }
 function setStars(n){ localStorage.setItem('tn_stars', String(n)); starsCounterEl.textContent = String(n); }
 
 markCorrectBtn.addEventListener('click', () => {
   const cur = getStars();
   setStars(cur+1);
   spawnBurst();
 });

 setStars(getStars());

 const galaxyCanvas = document.getElementById('galaxy');
 const gctx = galaxyCanvas.getContext('2d');
 let dpr = window.devicePixelRatio || 1;
 
 function resizeGalaxy(){
   const rect = galaxyCanvas.getBoundingClientRect();
   galaxyCanvas.width = rect.width * dpr;
   galaxyCanvas.height = rect.height * dpr;
 }
 resizeGalaxy();
 window.addEventListener('resize', resizeGalaxy);

 let particles = [];
 for(let i=0;i<80;i++) particles.push(randomParticle(true));

 function randomParticle(initial=false){
   const w = galaxyCanvas.width; const h = galaxyCanvas.height;
   return {
     x: initial ? Math.random()*w : w/2 + (Math.random()-0.5)*200*dpr,
     y: initial ? Math.random()*h : h/2 + (Math.random()-0.5)*120*dpr,
     vx: (Math.random()-0.5)*0.2*dpr,
     vy: (Math.random()-0.5)*0.2*dpr,
     size: 1 + Math.random()*3*dpr,
     hue: 180 + Math.random()*120
   };
 }

 function drawGalaxy(){
   const w = galaxyCanvas.width; const h = galaxyCanvas.height;
   gctx.clearRect(0,0,w,h);

   particles.forEach(p => {
     gctx.beginPath();
     gctx.fillStyle = `hsla(${p.hue},75%,65%,0.95)`;
     gctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
     gctx.fill();
     
     p.x += p.vx; p.y += p.vy;
     
     if(p.x < -10) p.x = w + 10;
     if(p.x > w + 10) p.x = -10;
     if(p.y < -10) p.y = h + 10;
     if(p.y > h + 10) p.y = -10;
   });

   requestAnimationFrame(drawGalaxy);
 }
 drawGalaxy();

 function spawnBurst(){
   for(let i=0;i<30;i++){
     particles.push({
       x: galaxyCanvas.width/2,
       y: galaxyCanvas.height/2,
       vx: (Math.random()-0.5)*6*dpr,
       vy: (Math.random()-0.5)*6*dpr,
       size: 1 + Math.random()*3*dpr,
       hue: 40 + Math.random()*200
     });
   }
   if(particles.length>500) particles = particles.slice(-400);
 }

 window.addEventListener('pagehide', () => stopCamera());
})();

// Load Leaflet and initialize map
const leafletScript = document.createElement('script');
leafletScript.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
leafletScript.onload = function() {
 let map = null;
 let markers = [];
 
 map = L.map('map', {scrollWheelZoom:false}).setView([29.425967,-98.486142], 12);
 L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
   maxZoom: 19, attribution: '© OpenStreetMap'
 }).addTo(map);

 const centers = [
   {name:'Northside Recycling Center', lat:29.4782, lng:-98.5421, types:['Plastic','Glass','Paper','Metal']},
   {name:'Eastside Hazardous Dropoff', lat:29.4209, lng:-98.4500, types:['E-Waste','Hazardous']},
   {name:'Green Loop Compost Hub', lat:29.3950, lng:-98.5000, types:['Compostable']},
   {name:'Downtown Recycle Depot', lat:29.4260, lng:-98.4890, types:['Plastic','Glass','Paper','Metal','Compostable']},
 ];

 markers = centers.map(c => {
   return L.marker([c.lat,c.lng]).addTo(map).bindPopup(`<strong>${c.name}</strong><div class="muted">Accepts: ${c.types.join(', ')}</div>`);
 });

 document.getElementById('showAll').addEventListener('click', () => {
   if (!map || !markers.length) return;
   const group = L.featureGroup(markers);
   map.fitBounds(group.getBounds().pad(0.3));
 });

 document.getElementById('locate').addEventListener('click', () => {
   if (!map) return;
   if(!navigator.geolocation){ alert('Geolocation not supported'); return; }
   navigator.geolocation.getCurrentPosition(pos => {
     const lat = pos.coords.latitude; const lng = pos.coords.longitude;
     L.circle([lat,lng], {radius:80, color:'#6c5ce7', fill:false}).addTo(map);
     map.setView([lat,lng], 13);
   }, err => { alert('Location permission denied or error'); });
 });
};
document.head.appendChild(leafletScript);
</script>
</body>
</html>